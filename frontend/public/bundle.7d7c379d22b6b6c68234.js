(()=>{"use strict";const e=class{constructor(e){this.params=e}setTitle(e){document.title=e}async getHtml(){return""}async routine(){}},t=class extends e{constructor(e){super(e),this.setTitle("Dashboard")}async getHtml(){return'\n            <h1>Welcome back, Dom</h1>\n            <p>\n                Fugiat voluptate et nisi Lorem cillum anim sit do eiusmod occaecat irure do. Reprehenderit anim fugiat sint exercitation consequat. Sit anim laborum sit amet Lorem adipisicing ullamco duis. Anim in do magna ea pariatur et.\n            </p>\n            <p>\n                <a href="/posts" data-link>View recent posts</a>.\n            </p>\n        '}};class a extends e{constructor(e){super(e),this.setTitle("ShowAll")}async getHtml(){var e,t;return"/fetch-all-notes",e=this.showAll,(t=new XMLHttpRequest).onreadystatechange=function(){4==this.readyState&&200==this.status&&e(JSON.parse(t.responseText))},t.open("GET","/fetch-all-notes",!0),t.send(),"\n          <h1>All of the notes</h1>\n      "}showAll(e){console.log(e);let t='<div id="note_list">';e.reverse().forEach((e=>{t+="<div><br>",t+=e.id+"   ",t+=e.title+"<br>",t+=e.body+"<br>",t+=`<button id='${e.id}' name='edit-note-btn'>Edit</button>`,t+=`<button id='${e.id}' name='delete-note-btn'>Delete</button>`,t+="</div>"})),document.querySelector("#app").innerHTML=t,document.querySelector("#note_list").addEventListener("click",a.buttonHandler)}static editNote(e){console.log("edit "+e)}static deleteNote(e){console.log("delete "+e)}static buttonHandler(e){"edit-note-btn"===e.srcElement.name?a.editNote(e.srcElement.id):"delete-note-btn"===e.srcElement.name&&a.deleteNote(e.srcElement.id)}}class n{constructor(e,t){this.currentFocus=-1,this.inp=e,this.arr=t,this.autocomplete()}autocomplete(){this.inp.addEventListener("input",this.inputListener.bind(this)),this.inp.addEventListener("keydown",this.keyDownListener.bind(this)),document.addEventListener("click",function(e){this.closeAllLists(e.target)}.bind(this))}keyDownListener(e){var t=document.getElementById(this.inp.id+"autocomplete-list");t&&(t=t.getElementsByTagName("div")),40==e.keyCode?(this.currentFocus++,this.addActive(t)):38==e.keyCode?(this.currentFocus--,this.addActive(t)):13==e.keyCode&&(e.preventDefault(),this.currentFocus>-1?t&&t[this.currentFocus].click():t&&1==t.length&&t[0].click())}inputListener(e){let t,a,n=this.inp.value;if(this.closeAllLists(),!n)return!1;this.inp.currentFocus=-1,t=document.createElement("DIV"),t.setAttribute("id",this.inp.id+"autocomplete-list"),t.setAttribute("class","autocomplete-items"),this.inp.parentNode.appendChild(t);for(let e=0;e<this.arr.length;e++)this.arr[e].substr(0,n.length).toUpperCase()==n.toUpperCase()&&(this.arr[e],a=document.createElement("DIV"),a.innerHTML="<strong>"+this.arr[e].substr(0,n.length)+"</strong>",a.innerHTML+=this.arr[e].substr(n.length),a.innerHTML+="<input type='hidden' value='"+this.arr[e]+"'>",a.addEventListener("click",function(e,t){this.inp.value=e,this.closeAllLists()}.bind(this,this.arr[e])),t.appendChild(a))}addActive(e){if(!e)return!1;this.removeActive(e),this.currentFocus>=e.length&&(this.currentFocus=0),this.currentFocus<0&&(this.currentFocus=e.length-1),e[this.currentFocus].classList.add("autocomplete-active")}removeActive(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autocomplete-active")}closeAllLists(e){for(var t=document.getElementsByClassName("autocomplete-items"),a=0;a<t.length;a++)e!=t[a]&&e!=this.inp&&t[a].parentNode.removeChild(t[a])}}class i extends e{constructor(e){super(e),this.setTitle("Settings")}async getHtml(){return'\n        <h2 class="text-center">Create note</h2>\n        <div id="error_message"></div>\n        <form autocomplete="off"  id="create-note-form"><br>\n        <div class="autocomplete">\n          <input size="100" name="title" id="title" type="text" class="" placeholder="Title"><br>\n        </div>\n          <textarea cols="100" name="body" id="body" placeholder="Note..." id="exampleFormControlTextarea1" rows="10"></textarea><br>\n        <div class="autocomplete">\n          <input size="100" name="tags" id="tags" type="text" class="" placeholder="Tags"><br>\n        </div>\n          <input size="100" name="links" id="links" type="text" class="" placeholder="Links"><br>\n          <button id="submit-btn">Create Note</button>\n        </form>\n      '}async routine(){document.getElementById("submit-btn").addEventListener("click",i.submit_form),new n(document.getElementById("title"),["note1","note3","note3","note4","note5"]),new n(document.getElementById("tags"),["tag1","tag3","tag3","tag4","tag5"])}static submit_form(e){e.preventDefault(),i.validateForm()&&function(e,t,a,n=(()=>{})){let i=document.getElementById(e),s=new FormData(i),o={};s.forEach(((e,t)=>o[t]=e)),function(e,t,a,n){const i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(200==i.status?a(JSON.parse(i.responseText)):n(JSON.parse(i.statusText)))},i.open("POST",t),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(e))}(o,t,a,n)}("create-note-form","/create",(e=>{document.querySelector("#error_message").innerHTML="Note has been saved.",console.log("sucsees create: "+e)}))}static validateForm(){let e="";if(""===document.getElementById("title").value.trim()&&(e+="Title can't be blank <br>"),""===document.getElementById("body").value.trim()&&(e+="Body can't be blank <br>"),""===document.getElementById("links").value.trim()&&(e+="Links field can't be blank <br>"),""===document.getElementById("tags").value.trim()&&(e+="Tags field can't be blank <br>"),""===e)return document.querySelector("#error_message").innerHTML="Sending...",!0;document.querySelector("#error_message").innerHTML=e}}let s=["Afghanistan","Albania","Algeria","Andorra","Angola","Anguilla","Antigua &amp; Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia &amp; Herzegovina","Botswana","Brazil","British Virgin Islands","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central Arfrican Republic","Chad","Chile","China","Colombia","Congo","Cook Islands","Costa Rica","Cote D Ivoire","Croatia","Cuba","Curacao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Polynesia","French West Indies","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guam","Guatemala","Guernsey","Guinea","Guinea Bissau","Guyana","Haiti","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Isle of Man","Israel","Italy","Jamaica","Japan","Jersey","Jordan","Kazakhstan","Kenya","Kiribati","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauro","Nepal","Netherlands","Netherlands Antilles","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","North Korea","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Pierre &amp; Miquelon","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","St Kitts &amp; Nevis","St Lucia","St Vincent","Sudan","Suriname","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor L'Este","Togo","Tonga","Trinidad &amp; Tobago","Tunisia","Turkey","Turkmenistan","Turks &amp; Caicos","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States of America","Uruguay","Uzbekistan","Vanuatu","Vatican City","Venezuela","Vietnam","Virgin Islands (US)","Yemen","Zambia","Zimbabwe"];class o extends e{constructor(e){super(e),this.postId=e.id,this.setTitle("Autocomplete")}async routine(){!function(e,t){var a;function n(e){if(!e)return!1;(function(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autocomplete-active")})(e),console.log("before "+e),a>=e.length&&(a=0),a<0&&(a=e.length-1),e[a].classList.add("autocomplete-active")}function i(t){for(var a=document.getElementsByClassName("autocomplete-items"),n=0;n<a.length;n++)t!=a[n]&&t!=e&&a[n].parentNode.removeChild(a[n])}e.addEventListener("input",(function(n){let s,o,r,l=this.value;if(i(),!l)return!1;for(a=-1,s=document.createElement("DIV"),s.setAttribute("id",this.id+"autocomplete-list"),s.setAttribute("class","autocomplete-items"),this.parentNode.appendChild(s),r=0;r<t.length;r++)t[r].substr(0,l.length).toUpperCase()==l.toUpperCase()&&(o=document.createElement("DIV"),o.innerHTML="<strong>"+t[r].substr(0,l.length)+"</strong>",o.innerHTML+=t[r].substr(l.length),o.innerHTML+="<input type='hidden' value='"+t[r]+"'>",o.addEventListener("click",(function(t){console.log(this),e.value=this.getElementsByTagName("input")[0].value,i()})),s.appendChild(o))})),e.addEventListener("keydown",(function(e){var t=document.getElementById(this.id+"autocomplete-list");console.log("before "+t),t&&(t=t.getElementsByTagName("div")),console.log("after "+t),40==e.keyCode?(a++,n(t)):38==e.keyCode?(a--,n(t)):13==e.keyCode&&(e.preventDefault(),a>-1?t&&t[a].click():t&&1==t.length&&t[0].click())})),document.addEventListener("click",(function(e){i(e.target)}))}(document.getElementById("myInput"),s)}async getHtml(){return'\n        <form autocomplete="off">\n          <div class="autocomplete" style="width:300px;">\n            <input id="myInput" type="text" name="myCountry" placeholder="Country">\n          </div>\n          <input type="submit">\n        </form>\n        '}}const r=class extends e{constructor(e){super(e),this.postId=e.id,this.setTitle("Viewing Post")}async getHtml(){return`\n            <h1>Post ${this.postId}</h1>\n            <p>You are viewing post #${this.postId}.</p>\n        `}},l=e=>{const t=e.result.slice(1),a=Array.from(e.route.path.matchAll(/:(\w+)/g)).map((e=>e[1]));return Object.fromEntries(a.map(((e,a)=>[e,t[a]]))),Object.fromEntries(a.map(((e,a)=>[e,t[a]])))},u=async()=>{const e=[{path:"/",view:t},{path:"/show_all",view:a},{path:"/create_note",view:i},{path:"/autocomplete",view:o},{path:"/posts/:id",view:r}];let n=e.map((e=>{return{route:e,result:location.pathname.match((t=e.path,new RegExp("^"+t.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$")))};var t})).find((e=>null!==e.result));n||(n={route:e[0],result:[location.pathname]}),l(n);const s=new n.route.view(l(n));document.querySelector("#app").innerHTML=await s.getHtml(),await s.routine()};window.addEventListener("popstate",u),document.addEventListener("DOMContentLoaded",(()=>{document.body.addEventListener("click",(e=>{var t;e.target.matches("[data-link]")&&(e.preventDefault(),t=e.target.href,history.pushState(null,null,t),u())})),u()}))})();